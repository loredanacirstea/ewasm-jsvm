!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t){e.exports=ethers},function(e,t,n){(function(t){const{ethers:r}=n(0),o=void 0!==t&&null!=t.versions&&null!=t.versions.node,i=e=>"0x"===e.slice(0,2)?e.slice(2):e,s=e=>r.utils.arrayify("0x"+(e=>e.length%2==1?"0"+e:e)(i(e))),a=e=>r.utils.hexlify(e),c=e=>{let t=[...Array(6).keys()].map(e=>e+97).concat([...Array(10).keys()].map(e=>e+48));return"0x"+[...Array(e).keys()].map(e=>Math.floor(16*Math.random())).map(e=>String.fromCharCode(t[e])).join("")};let u,l;o?(u=e=>e,l=e=>BigInt(e)):(u=e=>new WebAssembly.Global({value:"i32",mutable:!0},e),l=e=>new WebAssembly.Global({value:"i64",mutable:!0},e));e.exports={strip0x:i,encodeWithSignature:(e,t,n)=>{const o=r.utils.defaultAbiCoder.encode(t,n);return s(e+o.substring(2))},encode:(e,t)=>{const n=r.utils.defaultAbiCoder.encode(e,t);return s(n)},decode:(e,t)=>r.utils.defaultAbiCoder.decode(e,a(t)),logu8a:e=>`${e.join("")}, ${e.length}`,uint8ArrayToHex:a,hexToUint8Array:s,newi32:u,newi64:l,instantiateWasm:async(e,t)=>{if(o){const n=new WebAssembly.Module(e);return{instance:new WebAssembly.Instance(n,t),module:n}}return await WebAssembly.instantiateStreaming(new Promise((t,n)=>{t(new Response(e,{status:200,headers:{"Content-Type":"application/wasm"}}))}),t)},isHexWasm:e=>"0061736d"===e.substring(0,8),isBinWasm:e=>0===e[0]&&97===e[1]&&115===e[2]&&109===e[3],randomHex:c,randomHash:()=>c(64),randomAddress:()=>c(40)}}).call(this,n(4))},function(e,t,n){const{ethers:r}=n(0),{persistence:o,blocks:i,logs:s}=n(3),{encodeWithSignature:a,encode:c,decode:u,logu8a:l,uint8ArrayToHex:f,hexToUint8Array:m,newi32:g,newi64:d,randomAddress:b,instantiateWasm:h}=n(1),p=o(),y=i(),w=s(),x=(e,t)=>{const n=p.get(e).runtimeCode;return A(n,t,e,!0)},A=async(e,t,n,o=!1)=>{e="string"==typeof e?m(e):e;const i=new WebAssembly.Memory({initial:2}),s=y.set();let l;n=n||b();const g=(e,t,n)=>{const r=p.get(e).balance;if(r<n)throw new Error("Not enough balance.");const o=p.get(t).balance;p.updateBalance(t,o+n),p.updateBalance(e,r-n)};let d;const x=C(p,w,i,e,()=>l.calldata,()=>n,()=>l.txInfo.from,()=>l.txInfo.origin,()=>l.txInfo.value,()=>s,()=>d.exports.memory,()=>{if(!l)throw new Error("Get gas for inexistent transaction.");return l.gas},e=>{if(!l)throw new Error("Get gas for inexistent transaction.");l.gas.used+=e},e=>{if(!l)throw new Error("No queued promise found.");if("constructor"===l.name)p.set({runtimeCode:e,address:n}),g(l.txInfo.from,n,l.txInfo.value),l.resolve(n);else{const n=e?u(t.find(e=>e.name===l.name).outputs,e):e;l.resolve(n)}l=null},e=>{if(!l)throw new Error("No queued promise found.");const t=new Error("Revert: "+f(e));l.reject(t),l=null},g),A=await h(e,x);d=A.instance;const T=e=>o?e?e.name:"main":"constructor",S=e=>(t,n)=>new Promise((r,o)=>{if(l)throw new Error("No queue implemented. Come back later.");const i=T(e);l={resolve:r,reject:o,name:i,txInfo:n,gas:{limit:n.gasLimit,price:n.gasPrice,used:0},calldata:"string"==typeof t?m(t):t},d.exports.main()}),k=(e,n)=>(...r)=>{const o=T(n),i=r.slice(0,r.length-1),s=r[r.length-1];s.origin=s.origin||s.from,s.value=s.value||0;const u=(t.find(e=>e.name===o)||{}).inputs,l=e?a(e,u,i):c(u,i);return S(n)(l,s)},E={instance:d,main:k(),mainRaw:S(),address:n,abi:t,bin:e};return t.forEach(e=>{if("constructor"!==e.name)if("fallback"===e.type)E[e.name]=k();else{const t=r.utils.id(v(e)).substring(0,10);E[e.name]=k(t,e)}}),E},v=e=>`${e.name}(${e.inputs.map(e=>e.type).join(",")})`,C=(e,t,n,r,o,i,s,a,c,u,b,h,p,y,w,x)=>{const A=(e,t,n)=>{const r=b();let o=new Uint8Array(r.buffer);for(let r=0;r<n;r++)o[t+r]=e[r]},v=(e,t)=>{let n=b().buffer.slice(e,e+t);return new Uint8Array(n)};return{ethereum:{useGas:function(e){p(e)},getAddress:function(e){const t=new Uint8Array(32);t.set(m(i()),12),A(t,e,32)},getExternalBalance:function(t,n){let r=v(t,32);r=f(r).substring(0,42);const o=new Uint8Array(32),i=m(e.get(r).balance.toString(16));o.set(i,32-i.length),A(o,n,32),console.log("getExternalBalance",l(v(n,32)))},getBlockHash:function(e,t){const n=m(u().hash);return A(n,t,32),g(0)},call:function(e,t,n,r,o){return console.log("call",e,t,n,r,o),g(0)},callDataCopy:function(e,t,n){A(o().slice(t,t+n),e,n)},getCallDataSize:function(){return g(o().length)},callCode:function(e,t,n,r,o){return console.log("callCode",e,t,n,r,o),g(0)},callDelegate:function(e,t,n,r){return console.log("callDelegate",e,t,n,r),g(0)},callStatic:function(e,t,n,r){return console.log("callStatic",e,t,n,r),g(0)},storageStore:function(e,t){((e,t)=>{const r=b();let o=new Uint8Array(n.buffer),i=new Uint8Array(r.buffer);for(let n=0;n<32;n++)o[e+n]=i[t+n]})(e,t)},storageLoad:function(e,t){((e,t)=>{let r=n.buffer.slice(e,32);A(new Uint8Array(r),t,32)})(e,t)},getCaller:function(e){const t=new Uint8Array(32);t.set(m(s()),12),A(t,e,32)},getCallValue:function(e){const t=new Uint8Array(32),n=m(c().toString(16));t.set(n,32-n.length),A(t,e,32)},codeCopy:function(e,t,n){const o=r.slice(t,t+n);A(o,e,n)},getCodeSize:function(){return g(r.length)},getBlockCoinbase:function(e){const t=new Uint8Array(32),n=m(u().coinbase);t.set(n,32-n.length),A(t,e,32)},create:function(t,n,r,o){const i=parseInt(f(v(t,32)),16),s=v(n,r),a=e.set({runtimeCode:s,balance:i}),c=new Uint8Array(32),u=m(a);return c.set(u,32-u.length),A(c,o,32),g(0)},getBlockDifficulty:function(e){const t=new Uint8Array(32),n=m(u().difficulty.toString(16));t.set(n,32-n.length),A(t,e,32)},externalCodeCopy:function(t,n,r,o){let i=v(t,32);i=f(i).substring(0,42);const s=e.get(i).runtimeCode.slice(r,r+o);A(s,n,o)},getExternalCodeSize:function(t){let n=v(t,32);return n=f(n).substring(0,42),g(e.get(n).runtimeCode.length)},getGasLeft:function(){const e=h();return d(e.limit-e.used)},getBlockGasLimit:function(){return d(u().gasLimit)},getTxGasPrice:function(e){const t=new Uint8Array(32),n=m(h().price.toString(16));t.set(n,32-n.length),A(t,e,32)},log:function(e,n,r,...o){t.set({blockNumber:u().number,data:v(e,n),topics:o.slice(0,r)})},getBlockNumber:function(){return d(u().number)},getTxOrigin:function(e){const t=new Uint8Array(32);t.set(m(a()),12),A(t,e,32)},finish:function(e,t){const n=v(e,t);y(n)},revert:function(e,t){const n=v(e,t);w(n)},getReturnDataSize:function(){return console.log("getReturnDataSize"),g(64)},returnDataCopy:function(e,t,n){console.log("returnDataCopy",e,t,n)},selfDestruct:function(t){let n=v(t,32);n=f(n).substring(0,42);const r=i();x(r,n,e.get(r).balance),e.remove(r),y()},getBlockTimestamp:function(){return d(u().timestamp)}}}};e.exports={deploy:(e,t)=>async(...n)=>{const r=await A(e,t,null,!1),o=n[n.length-1],i=await r.main(o);return await x(i,t)},runtime:x,runtimeSim:(e,t,n)=>A(e,t,n=n||"0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",!0),getBlock:e=>y.get(e),getLogs:()=>w,getPersistence:()=>p}},function(e,t,n){const{randomHash:r,randomAddress:o}=n(1);e.exports={persistence:()=>{const e={};return{get:t=>e[t],set:({address:t,runtimeCode:n,balance:r=0})=>{if(t=t||o(),e[t])throw new Error("Address already exists");return n=n||new Uint8Array(0),e[t]={runtimeCode:n,balance:r},t},updateBalance:(t,n)=>{e[t].balance=n},remove:t=>{if(e[t].balance>0)throw new Error("Contract removal failed, because it still has money.");delete e[t]}}},blocks:()=>{let e=0;const t=[],n={};return{get:n=>parseInt(n)===n?t[n]:t[e-1],set:()=>{const i={number:e,timestamp:(new Date).getTime(),hash:r(),difficulty:0x832cc06828c9c,gasLimit:8e6,coinbase:o()};return t.push(i),n[i.hash]=e,e++,i}}},logs:()=>{const e=[],t={};return{set:n=>{e.push(n),t[n.blockNumber]||(t[n.blockNumber]=[]),t[n.blockNumber].push(n)},getBlockLogs:e=>t[e],getLogs:()=>e}}}},function(e,t){var n,r,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var c,u=[],l=!1,f=-1;function m(){l&&c&&(l=!1,c.length?u=c.concat(u):f=-1,u.length&&g())}function g(){if(!l){var e=a(m);l=!0;for(var t=u.length;t;){for(c=u,u=[];++f<t;)c&&c[f].run();f=-1,t=u.length}c=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function b(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new d(e,t)),1!==u.length||l||a(g)},d.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=b,o.addListener=b,o.once=b,o.off=b,o.removeListener=b,o.removeAllListeners=b,o.emit=b,o.prependListener=b,o.prependOnceListener=b,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}}]);